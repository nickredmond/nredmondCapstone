package genetics;

import java.util.Random;

public class RouletteChromosomeChooser implements IChromosomeChooser{
	private final int MAX_NUMBER_SLICES = 10;
	
	@Override
	public int[] chooseChromosome(Chromosome[] chromosomes) {
		int totalSlices = 0;
		
		float maxFitness = 0.0f;
		float minFitness = 1.0f;
		
		for (int i = 0; i < chromosomes.length; i++){
			float fitness = chromosomes[i].getFitness();
			if (fitness > maxFitness){
				maxFitness = fitness;
			}
			if (fitness < minFitness){
				minFitness = fitness;
			}
		}
		
		float fitnessDifference = maxFitness - minFitness;
		float differencePerSlice = fitnessDifference / MAX_NUMBER_SLICES;
		
		for (int i = 0; i < chromosomes.length; i++){
			int nextSliceNumber = (int)(chromosomes[i].getFitness() * 10);
			totalSlices += (nextSliceNumber > 0) ? nextSliceNumber : 1;
		}
		
		int[][] rouletteChromosomeSet = new int[totalSlices][chromosomes[0].getGenes().length];
		int setIndex = 0;
		
		for (int i = 0; i < chromosomes.length; i++){
			int numSlices = (int)(chromosomes[i].getFitness() * 10);
			
			if (numSlices == 0)
				numSlices++;
			
			for (int j = 0; j < numSlices; j++){
				rouletteChromosomeSet[setIndex] = chromosomes[i].getGenes();
				setIndex++;
			}
		}
		
		Random rand = new Random();
		int index = 0;
		try{
		index = rand.nextInt(rouletteChromosomeSet.length);
		}catch(IllegalArgumentException e){
			int x = 0;
		}
		
		return rouletteChromosomeSet[index];
	}
}
